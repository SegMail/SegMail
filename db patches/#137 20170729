-- Rename tables
RENAME TABLE `BATCH_JOB_CONDTION` TO `BATCH_JOB_CONDITION`;
RENAME TABLE `ENTEPRRISE_TRANSACTION` TO `ENTERPRISE_TRANSACTION`;
RENAME TABLE `ENTEPRRISE_TRANSACTION_PARAM` TO `ENTERPRISE_TRANSACTION_PARAM`;
RENAME TABLE `ENTERPRISEOBJECT` TO `ENTERPRISE_OBJECT`;
RENAME TABLE `MENU_ITEM_ACCESS` TO `MENUITEM_ACCESS`;

-- Update all foreign keys
-- Execute this select, and run its output (if any)

-- BATCH_JOB_CONDTION
SELECT concat('ALTER TABLE ', TABLE_NAME, ' DROP FOREIGN KEY ', CONSTRAINT_NAME, ';'
             ,'ALTER TABLE ', TABLE_NAME, ' ADD CONSTRAINT ', CONSTRAINT_NAME
             , ' FOREIGN KEY (', COLUMN_NAME ,') REFERENCES BATCH_JOB_CONDITION (',COLUMN_NAME,');') 
FROM information_schema.key_column_usage 
WHERE CONSTRAINT_SCHEMA = 'segmail' 
AND referenced_table_name = 'BATCH_JOB_CONDTION';

-- ENTEPRRISE_TRANSACTION
SELECT concat('ALTER TABLE ', TABLE_NAME, ' DROP FOREIGN KEY ', CONSTRAINT_NAME, ';'
             ,'ALTER TABLE ', TABLE_NAME, ' ADD CONSTRAINT ', CONSTRAINT_NAME
             , ' FOREIGN KEY (', COLUMN_NAME ,') REFERENCES ENTERPRISE_TRANSACTION (',COLUMN_NAME,');') 
FROM information_schema.key_column_usage 
WHERE CONSTRAINT_SCHEMA = 'segmail' 
AND referenced_table_name = 'ENTEPRRISE_TRANSACTION';

-- ENTEPRRISE_TRANSACTION_PARAM
SELECT concat('ALTER TABLE ', TABLE_NAME, ' DROP FOREIGN KEY ', CONSTRAINT_NAME, ';'
             ,'ALTER TABLE ', TABLE_NAME, ' ADD CONSTRAINT ', CONSTRAINT_NAME
             , ' FOREIGN KEY (', COLUMN_NAME ,') REFERENCES ENTERPRISE_TRANSACTION_PARAM (',COLUMN_NAME,');') 
FROM information_schema.key_column_usage 
WHERE CONSTRAINT_SCHEMA = 'segmail' 
AND referenced_table_name = 'ENTEPRRISE_TRANSACTION_PARAM';

-- ENTERPRISEOBJECT
SELECT concat('ALTER TABLE ', TABLE_NAME, ' DROP FOREIGN KEY ', CONSTRAINT_NAME, ';'
             ,'ALTER TABLE ', TABLE_NAME, ' ADD CONSTRAINT ', CONSTRAINT_NAME
             , ' FOREIGN KEY (', COLUMN_NAME ,') REFERENCES ENTERPRISE_OBJECT (',COLUMN_NAME,');') 
FROM information_schema.key_column_usage 
WHERE CONSTRAINT_SCHEMA = 'segmail' 
AND referenced_table_name = 'ENTERPRISEOBJECT';

-- MENU_ITEM_ACCESS
SELECT concat('ALTER TABLE ', TABLE_NAME, ' DROP FOREIGN KEY ', CONSTRAINT_NAME, ';'
             ,'ALTER TABLE ', TABLE_NAME, ' ADD CONSTRAINT ', CONSTRAINT_NAME
             , ' FOREIGN KEY (', COLUMN_NAME ,') REFERENCES MENUITEM_ACCESS (',COLUMN_NAME,');') 
FROM information_schema.key_column_usage 
WHERE CONSTRAINT_SCHEMA = 'segmail' 
AND referenced_table_name = 'MENU_ITEM_ACCESS';