<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:s2="http://seca2.jsf/custom"
      xmlns:cc="http://xmlns.jcp.org/jsf/composite">
    <!--==========================
     demo.js  http://plugins.jquery.com/soap/ or https://github.com/doedje/jquery.soap
     part of the jQuery.soap distribution version: 1.6.0
     
     this file contains the javascript for the jQuery.soap demo
     ===========================-->
    <script>

        $(document).ready(function () {
            $("#slider").on("slidechange", function (event, ui) {
                //window.alert("Slider has been changed");
                var points = window.myLine.datasets[0].points;
                points.forEach(function (entry) {
                    entry.value = $("#slider").slider("value") - entry.value;
                })
                window.myLine.update();
            });
            $("#principalInput").bind("change paste keyup", function () {
                var callout = callSOAP();
            });
            function callSOAP() {
                return $.soap({
                    url: '#{ProgramChartJS.WEB_SERVICE_ENDPOINT}',
                    method: '#{ProgramChartJS.WEB_SERVICE_METHOD}',
                    appendMethodToURL: 0,
                    SOAPAction: '',
                    soap12: $('#soap12').prop('checked'),
                    async: $('#async').prop('checked'),
                    data: {
                        int: $('#intRateInput').val(),
                        n: $('#numYearsInput').val(),
                        p: $('#principalInput').val()
                    },
                    //wss: wss,
                    HTTPHeaders: {
                        // Authentication: 'Basic ' + btoa('test:test')
                    },
                    envAttributes: {
                        'xmlns:test': 'http://www.test.org/'
                    },
                    SOAPHeader: '<test>SOAPHeader</test>',
                    //namespaceQualifier: $('#namespaceQualifier').val(),
                    //namespaceURL: $('#namespaceURL').val(),
                    //noPrefix: $('#noPrefix').prop('checked'),
                    //elementName: $('#elementName').val(),
                    //enableLogging: $('#enableLogging').prop('checked'),
                    //context: $('#feedback'),
                    //beforeSend: function (SOAPEnvelope) {
                    //    var xmlout = dom2html($.parseXML(SOAPEnvelope.toString()).firstChild);
                    //    $('#requestXML').text(xmlout);
                    //},
                    success: function (SOAPResponse) {

                        //	console.log(this)

                        $('#soapcall').html('Response: Success!');
                        //$('#soapcall').text(dom2html(SOAPResponse.toXML().firstChild));
                    },
                    error: function (SOAPResponse) {

                        console.log(this)

                        $('#soapcall').html('Response: Error!');
                        $('#soapcall').text(SOAPResponse.toString());
                    },
                    statusCode: {
                        404: function () {
                            console.log('404')
                        },
                        200: function () {
                            console.log('200')
                        }
                    }
                });
            }
        });

    </script>
</html>